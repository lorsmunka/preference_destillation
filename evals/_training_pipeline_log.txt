(.venv) PS C:\Users\Ors\preference_destillation> & C:\Users\Ors\preference_destillation\.venv\Scripts\python.exe c:/Users/Ors/preference_destillation/transformer/main.py
Initializing Transformer model...
Pre-computed 93 unique tokens for vocabulary map.
=== Model Parameter Overview ===
Total trainable parameters: 470,149,213
Embeddings (input + positional): 268,512,256 (268,435,456 + 76,800)
Transformer Attention parameters: 67,174,400
Transformer Feed-Forward parameters: 134,299,648
Transformer Block LayerNorms: 65,536
Final LayerNorm parameters: 2,048
Output projection parameters: 95,325

Sum of all above: 470,149,213
Difference (if any): 0

Hyperparameters: Hidden dimension=1024, Heads=16, Layers=16, Max sequence length=75
Input vocab size=262144, Output vocab size=93
Model initialized -> took 4.28 seconds.

Loading telemetry...
Loaded telemetry -> took 0.01 seconds.

== Telemetry ==
Current epoch: 21
Current batch: 257
Total batches processed: 3,029
Total runtime (seconds): 349,767.84
Session count: 108
Training log file: telemetry\training.jsonl
Waiting 2 seconds before continuing...

Initializing Trainer...
Trainer initialized on cuda -> took 0.42 seconds (T_max=11232)

Resuming from epoch 22, batch 257

Checkpoint loaded: checkpoints/temp_checkpoint.pt (epoch 21) -> took 3.59s

Loaded temp checkpoint


Epoch 22/24

Training Epoch 21 with starting learning rate: 0.000032

Loading batch 258...
Loaded batch 258 -> took 0.03 seconds.
        Example 1/32: 39 steps, loss=0.0546, kl=0.0582, ce=0.0531, acc=0.9744 -> took 1.64s
        Example 2/32: 39 steps, loss=0.0463, kl=0.0361, ce=0.0507, acc=0.9744 -> took 1.19s
        Example 3/32: 38 steps, loss=0.0480, kl=0.0523, ce=0.0462, acc=0.9737 -> took 1.24s
        Example 4/32: 38 steps, loss=0.1852, kl=0.1660, ce=0.1934, acc=0.8684 -> took 1.21s
        Example 5/32: 39 steps, loss=0.0531, kl=0.0497, ce=0.0546, acc=0.9487 -> took 1.24s
        Example 6/32: 39 steps, loss=0.0708, kl=0.0786, ce=0.0674, acc=0.9744 -> took 1.24s
        Example 7/32: 39 steps, loss=0.0729, kl=0.0703, ce=0.0740, acc=1.0000 -> took 1.24s
        Example 8/32: 39 steps, loss=0.1191, kl=0.1030, ce=0.1259, acc=0.9487 -> took 1.26s
        Example 9/32: 39 steps, loss=0.1028, kl=0.0892, ce=0.1087, acc=0.9487 -> took 1.25s
        Example 10/32: 38 steps, loss=0.0444, kl=0.0508, ce=0.0416, acc=0.9737 -> took 1.23s
        Example 11/32: 39 steps, loss=0.0602, kl=0.0553, ce=0.0623, acc=1.0000 -> took 1.26s
        Example 12/32: 39 steps, loss=0.0810, kl=0.0657, ce=0.0876, acc=0.9487 -> took 1.24s
        Example 13/32: 39 steps, loss=0.0718, kl=0.0676, ce=0.0737, acc=0.9744 -> took 1.24s
        Example 14/32: 39 steps, loss=0.0287, kl=0.0336, ce=0.0267, acc=1.0000 -> took 1.25s
        Example 15/32: 38 steps, loss=0.2956, kl=0.2718, ce=0.3057, acc=0.8421 -> took 1.21s
        Example 16/32: 39 steps, loss=0.0517, kl=0.0513, ce=0.0518, acc=0.9744 -> took 1.24s
        Example 17/32: 39 steps, loss=0.0323, kl=0.0306, ce=0.0330, acc=1.0000 -> took 1.22s
        Example 18/32: 39 steps, loss=0.0965, kl=0.0864, ce=0.1009, acc=0.9487 -> took 1.23s
        Example 19/32: 39 steps, loss=0.0439, kl=0.0323, ce=0.0489, acc=0.9744 -> took 1.24s
        Example 20/32: 39 steps, loss=0.0506, kl=0.0495, ce=0.0511, acc=0.9744 -> took 1.23s
        Example 21/32: 39 steps, loss=0.1113, kl=0.0969, ce=0.1174, acc=0.9231 -> took 1.24s
        Example 22/32: 39 steps, loss=0.0814, kl=0.0748, ce=0.0843, acc=0.9744 -> took 1.24s
        Example 23/32: 39 steps, loss=0.0333, kl=0.0333, ce=0.0333, acc=1.0000 -> took 1.25s
        Example 24/32: 38 steps, loss=0.0571, kl=0.0528, ce=0.0589, acc=0.9474 -> took 1.21s
        Example 25/32: 39 steps, loss=0.0231, kl=0.0174, ce=0.0255, acc=1.0000 -> took 1.24s
        Example 26/32: 39 steps, loss=0.0704, kl=0.0563, ce=0.0764, acc=0.9744 -> took 1.24s
        Example 27/32: 39 steps, loss=0.0283, kl=0.0203, ce=0.0317, acc=1.0000 -> took 1.25s
        Example 28/32: 39 steps, loss=0.2572, kl=0.2373, ce=0.2657, acc=0.8718 -> took 1.23s
        Example 29/32: 39 steps, loss=0.1258, kl=0.1170, ce=0.1296, acc=0.8974 -> took 1.21s
        Example 30/32: 39 steps, loss=0.0388, kl=0.0386, ce=0.0388, acc=1.0000 -> took 1.24s
        Example 31/32: 39 steps, loss=0.0975, kl=0.0904, ce=0.1006, acc=0.9744 -> took 1.23s
        Example 32/32: 39 steps, loss=0.0281, kl=0.0269, ce=0.0287, acc=1.0000 -> took 1.23s
Batch 258 -> LR after decay: 0.00003242
Batch 258 processed: 1243 total steps, loss=0.0799, kl=0.0736, ce=0.0826, accuracy=0.9622 -> took 39.95s

Loading batch 259...
Loaded batch 259 -> took 0.03 seconds.
        Example 1/32: 39 steps, loss=0.0504, kl=0.0540, ce=0.0489, acc=0.9744 -> took 1.20s
        Example 2/32: 39 steps, loss=0.0512, kl=0.0555, ce=0.0493, acc=0.9487 -> took 1.24s
        Example 3/32: 39 steps, loss=0.0419, kl=0.0371, ce=0.0440, acc=1.0000 -> took 1.24s
        Example 4/32: 39 steps, loss=0.0779, kl=0.0628, ce=0.0844, acc=0.9487 -> took 1.24s
        Example 5/32: 38 steps, loss=0.0460, kl=0.0508, ce=0.0439, acc=0.9737 -> took 1.24s
        Example 6/32: 39 steps, loss=0.0333, kl=0.0371, ce=0.0317, acc=1.0000 -> took 1.23s
        Example 7/32: 39 steps, loss=0.0488, kl=0.0272, ce=0.0581, acc=0.9744 -> took 1.22s
        Example 8/32: 39 steps, loss=0.0445, kl=0.0464, ce=0.0437, acc=0.9744 -> took 1.23s
        Example 9/32: 38 steps, loss=0.0444, kl=0.0484, ce=0.0427, acc=0.9737 -> took 1.19s
        Example 10/32: 39 steps, loss=0.0471, kl=0.0533, ce=0.0444, acc=1.0000 -> took 1.24s
        Example 11/32: 39 steps, loss=0.0243, kl=0.0291, ce=0.0222, acc=1.0000 -> took 1.24s
        Example 12/32: 39 steps, loss=0.0390, kl=0.0342, ce=0.0411, acc=0.9744 -> took 1.26s
        Example 13/32: 39 steps, loss=0.0609, kl=0.0528, ce=0.0644, acc=1.0000 -> took 1.24s
        Example 14/32: 39 steps, loss=0.0635, kl=0.0701, ce=0.0607, acc=0.9487 -> took 1.23s
        Example 15/32: 39 steps, loss=0.0665, kl=0.0594, ce=0.0695, acc=1.0000 -> took 1.23s
        Example 16/32: 39 steps, loss=0.0416, kl=0.0379, ce=0.0432, acc=0.9744 -> took 1.23s
        Example 17/32: 39 steps, loss=0.1149, kl=0.1110, ce=0.1166, acc=0.9744 -> took 1.22s
        Example 18/32: 39 steps, loss=0.0319, kl=0.0306, ce=0.0325, acc=1.0000 -> took 1.22s
        Example 19/32: 39 steps, loss=0.0234, kl=0.0269, ce=0.0219, acc=1.0000 -> took 1.21s
        Example 20/32: 39 steps, loss=0.0659, kl=0.0598, ce=0.0686, acc=0.9744 -> took 1.32s
        Example 21/32: 39 steps, loss=0.0870, kl=0.0760, ce=0.0917, acc=0.9487 -> took 1.29s
        Example 22/32: 38 steps, loss=0.0804, kl=0.0755, ce=0.0825, acc=0.9474 -> took 1.34s
        Example 23/32: 39 steps, loss=0.0876, kl=0.0784, ce=0.0915, acc=0.9487 -> took 1.30s
        Example 24/32: 39 steps, loss=0.1603, kl=0.1302, ce=0.1731, acc=0.8974 -> took 1.30s
        Example 25/32: 39 steps, loss=0.0429, kl=0.0444, ce=0.0422, acc=0.9744 -> took 1.34s
        Example 26/32: 38 steps, loss=0.0605, kl=0.0482, ce=0.0658, acc=0.9474 -> took 1.27s
        Example 27/32: 39 steps, loss=0.0340, kl=0.0316, ce=0.0350, acc=1.0000 -> took 1.30s
        Example 28/32: 39 steps, loss=0.0781, kl=0.0746, ce=0.0796, acc=0.9487 -> took 1.32s
        Example 29/32: 39 steps, loss=0.0483, kl=0.0490, ce=0.0481, acc=0.9744 -> took 1.28s
        Example 30/32: 39 steps, loss=0.0355, kl=0.0343, ce=0.0360, acc=1.0000 -> took 1.29s
        Example 31/32: 39 steps, loss=0.0319, kl=0.0272, ce=0.0339, acc=1.0000 -> took 1.31s
        Example 32/32: 39 steps, loss=0.0409, kl=0.0403, ce=0.0411, acc=1.0000 -> took 1.33s
Batch 259 -> LR after decay: 0.00003239
Batch 259 processed: 1244 total steps, loss=0.0564, kl=0.0529, ce=0.0579, accuracy=0.9751 -> took 40.38s

Loading batch 260...
Loaded batch 260 -> took 0.03 seconds.
        Example 1/32: 39 steps, loss=0.0332, kl=0.0352, ce=0.0323, acc=1.0000 -> took 1.29s
        Example 2/32: 39 steps, loss=0.0425, kl=0.0523, ce=0.0383, acc=0.9744 -> took 1.37s
        Example 3/32: 39 steps, loss=0.0559, kl=0.0605, ce=0.0540, acc=0.9744 -> took 1.34s
        Example 4/32: 39 steps, loss=0.0683, kl=0.0691, ce=0.0680, acc=0.9744 -> took 1.30s
        Example 5/32: 38 steps, loss=0.0852, kl=0.0332, ce=0.1075, acc=0.9737 -> took 1.29s
        Example 6/32: 39 steps, loss=0.0334, kl=0.0357, ce=0.0325, acc=1.0000 -> took 1.32s
        Example 7/32: 39 steps, loss=0.0365, kl=0.0259, ce=0.0411, acc=1.0000 -> took 1.25s
        Example 8/32: 39 steps, loss=0.0411, kl=0.0332, ce=0.0445, acc=1.0000 -> took 1.31s
        Example 9/32: 39 steps, loss=0.0756, kl=0.0651, ce=0.0801, acc=0.9744 -> took 1.31s
        Example 10/32: 38 steps, loss=0.1807, kl=0.1851, ce=0.1788, acc=0.9474 -> took 1.27s
        Example 11/32: 39 steps, loss=0.0371, kl=0.0392, ce=0.0363, acc=1.0000 -> took 1.26s
        Example 12/32: 38 steps, loss=0.2529, kl=0.2053, ce=0.2733, acc=0.8421 -> took 1.21s
        Example 13/32: 39 steps, loss=0.0372, kl=0.0375, ce=0.0371, acc=1.0000 -> took 1.24s
        Example 14/32: 38 steps, loss=0.0949, kl=0.0855, ce=0.0989, acc=0.9474 -> took 1.20s
        Example 15/32: 39 steps, loss=0.1630, kl=0.1487, ce=0.1692, acc=0.8974 -> took 1.23s
        Example 16/32: 39 steps, loss=0.2065, kl=0.1956, ce=0.2112, acc=0.8718 -> took 1.23s
        Example 17/32: 39 steps, loss=0.1945, kl=0.1894, ce=0.1968, acc=0.9744 -> took 1.25s
        Example 18/32: 40 steps, loss=0.3414, kl=0.3252, ce=0.3483, acc=0.8750 -> took 1.27s
        Example 19/32: 39 steps, loss=0.0462, kl=0.0477, ce=0.0456, acc=1.0000 -> took 1.28s
        Example 20/32: 39 steps, loss=0.0659, kl=0.0627, ce=0.0673, acc=0.9744 -> took 1.29s
        Example 21/32: 38 steps, loss=0.2382, kl=0.2157, ce=0.2479, acc=0.8684 -> took 1.24s
        Example 22/32: 39 steps, loss=0.0673, kl=0.0531, ce=0.0733, acc=0.9744 -> took 1.29s
        Example 23/32: 39 steps, loss=0.2910, kl=0.2692, ce=0.3003, acc=0.8718 -> took 1.27s
        Example 24/32: 39 steps, loss=0.0728, kl=0.0658, ce=0.0758, acc=0.9744 -> took 1.28s
        Example 25/32: 38 steps, loss=0.2111, kl=0.1850, ce=0.2222, acc=0.9474 -> took 1.26s
        Example 26/32: 39 steps, loss=0.0353, kl=0.0399, ce=0.0334, acc=1.0000 -> took 1.27s
        Example 27/32: 38 steps, loss=0.0480, kl=0.0556, ce=0.0447, acc=0.9737 -> took 1.25s
        Example 28/32: 38 steps, loss=0.0903, kl=0.0903, ce=0.0904, acc=0.9474 -> took 1.24s
        Example 29/32: 38 steps, loss=0.0619, kl=0.0497, ce=0.0671, acc=0.9474 -> took 1.26s
        Example 30/32: 39 steps, loss=0.0369, kl=0.0343, ce=0.0380, acc=0.9744 -> took 1.27s
        Example 31/32: 39 steps, loss=0.0783, kl=0.0479, ce=0.0914, acc=0.9744 -> took 1.25s
        Example 32/32: 38 steps, loss=0.0429, kl=0.0529, ce=0.0386, acc=0.9737 -> took 1.26s
Batch 260 -> LR after decay: 0.00003236
Batch 260 processed: 1239 total steps, loss=0.1052, kl=0.0966, ce=0.1088, accuracy=0.9572 -> took 40.72s

Loading batch 261...
Loaded batch 261 -> took 0.03 seconds.
        Example 1/32: 39 steps, loss=0.0228, kl=0.0294, ce=0.0200, acc=1.0000 -> took 1.25s
        Example 2/32: 39 steps, loss=0.0598, kl=0.0608, ce=0.0594, acc=0.9744 -> took 1.25s
        Example 3/32: 39 steps, loss=0.0332, kl=0.0225, ce=0.0378, acc=1.0000 -> took 1.29s
        Example 4/32: 39 steps, loss=0.0491, kl=0.0528, ce=0.0476, acc=0.9744 -> took 1.25s
Exit key registered.
        Example 5/32: 38 steps, loss=0.1654, kl=0.1590, ce=0.1682, acc=0.9474 -> took 1.21s
        Example 6/32: 39 steps, loss=0.0388, kl=0.0377, ce=0.0393, acc=0.9744 -> took 1.25s
        Example 7/32: 39 steps, loss=0.0311, kl=0.0332, ce=0.0301, acc=1.0000 -> took 1.23s
        Example 8/32: 39 steps, loss=0.0804, kl=0.0535, ce=0.0919, acc=0.9744 -> took 1.27s
        Example 9/32: 38 steps, loss=0.1076, kl=0.0925, ce=0.1141, acc=0.9211 -> took 1.22s
        Example 10/32: 38 steps, loss=0.2409, kl=0.2202, ce=0.2497, acc=0.9211 -> took 1.22s
        Example 11/32: 39 steps, loss=0.0560, kl=0.0467, ce=0.0599, acc=1.0000 -> took 1.24s
        Example 12/32: 39 steps, loss=0.0509, kl=0.0496, ce=0.0515, acc=0.9487 -> took 1.23s
        Example 13/32: 38 steps, loss=0.0895, kl=0.0550, ce=0.1043, acc=0.9737 -> took 1.21s
        Example 14/32: 39 steps, loss=0.0326, kl=0.0261, ce=0.0353, acc=1.0000 -> took 1.24s
        Example 15/32: 38 steps, loss=0.0464, kl=0.0446, ce=0.0472, acc=0.9737 -> took 1.24s
        Example 16/32: 39 steps, loss=0.0541, kl=0.0547, ce=0.0539, acc=0.9744 -> took 1.23s
        Example 17/32: 38 steps, loss=0.1011, kl=0.0861, ce=0.1075, acc=0.9211 -> took 1.23s
        Example 18/32: 39 steps, loss=0.0328, kl=0.0270, ce=0.0353, acc=1.0000 -> took 1.23s
        Example 19/32: 39 steps, loss=0.0382, kl=0.0357, ce=0.0393, acc=0.9744 -> took 1.25s
        Example 20/32: 39 steps, loss=0.1584, kl=0.1443, ce=0.1645, acc=0.9487 -> took 1.26s
        Example 21/32: 39 steps, loss=0.0957, kl=0.0675, ce=0.1078, acc=0.9744 -> took 1.24s
        Example 22/32: 39 steps, loss=0.0856, kl=0.0817, ce=0.0873, acc=0.9487 -> took 1.24s
        Example 23/32: 39 steps, loss=0.0402, kl=0.0331, ce=0.0432, acc=0.9744 -> took 1.26s
        Example 24/32: 39 steps, loss=0.0495, kl=0.0322, ce=0.0569, acc=0.9744 -> took 1.24s
        Example 25/32: 39 steps, loss=0.0440, kl=0.0516, ce=0.0408, acc=0.9744 -> took 1.25s
        Example 26/32: 39 steps, loss=0.0302, kl=0.0289, ce=0.0307, acc=1.0000 -> took 1.25s
        Example 27/32: 39 steps, loss=0.0604, kl=0.0545, ce=0.0629, acc=0.9744 -> took 1.27s
        Example 28/32: 39 steps, loss=0.0700, kl=0.0765, ce=0.0672, acc=0.9487 -> took 1.25s
        Example 29/32: 39 steps, loss=0.0605, kl=0.0586, ce=0.0613, acc=0.9744 -> took 1.25s
        Example 30/32: 39 steps, loss=0.0633, kl=0.0679, ce=0.0614, acc=0.9744 -> took 1.23s
        Example 31/32: 39 steps, loss=0.0412, kl=0.0356, ce=0.0437, acc=1.0000 -> took 1.27s
        Example 32/32: 39 steps, loss=0.2362, kl=0.2122, ce=0.2465, acc=0.8718 -> took 1.24s
Batch 261 -> LR after decay: 0.00003233
Batch 261 processed: 1242 total steps, loss=0.0737, kl=0.0664, ce=0.0768, accuracy=0.9686 -> took 39.84s

Exit requested. Saving progress...
Temp checkpoint saved: checkpoints/temp_checkpoint.pt -> took 4.64s

Saving telemetry...
Saved telemetry to ./telemetry/training_telemetry.json -> took 0.00 seconds.

Bye!